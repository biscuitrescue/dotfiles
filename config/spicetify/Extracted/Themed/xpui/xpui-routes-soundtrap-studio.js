"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[3780],{22578:(e,t,r)=>{r.d(t,{$:()=>f});var n=r(64593),s=r(96206),o=r(69691),i=r(8341),a=r(89952),c=r(67294),l=r(51615),u=r(24183);var p=r(85893);function d(e){return e.includes("Spotify")?e:`Spotify – ${e}`}const f=({children:e,usePlayingItem:t})=>{let r=d(e);(e=>{const{mainLandmarkRef:t}=(0,u.Oh)(),r=(0,l.k6)(),n=r.location?.state?.preventMoveFocus,s=(0,c.useRef)(r.length<2);s.current=r.length<2,(0,c.useEffect)((()=>{const r=t.current;!n&&!s.current&&r&&e&&(r.setAttribute("aria-label",e),r.focus())}),[e,t,n])})(e);const{isPlaying:f}=(0,o.IK)(),h=(0,i.Y)((e=>e?.item));return h&&(f||t)&&((0,a.G_)(h)?r=[h.name,h.artists.map((e=>e.name)).join(s.ag.getSeparator())].join(" • "):(0,a.iw)(h)?r=[h.name,h.show.name].join(" • "):(0,a.k6)(h)&&(r=d(s.ag.get("ad-formats.advertisement")))),(0,p.jsx)(n.q,{defaultTitle:"Spotify",defer:!1,children:(0,p.jsx)("title",{children:r})})}},19207:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var n=r(67294),s=r(94184),o=r.n(s),i=r(86706),a=r(51615),c=r(69518),l=r.n(c),u=r(96206),p=r(22578),d=r(6158),f=r(23701),h=r(50709),w=r(67448);var m=r(99125),g=r(23716),I=r(8341),j=r(35761);const k="_8NXEiIW8UUvsBVNhHdc",y="pZytOOt4d5hSOwPD8A_V";var v=r(85893);const S=(0,n.memo)((()=>{const e=(0,f.n)(),{projectId:t,songId:r}=(0,a.UO)(),s=(0,n.useRef)(null),c=(0,i.I0)(),S=(0,w.z)(),b=(0,a.k6)(),E=(0,n.useMemo)((()=>[["showtippopups",0],["workflow","cover"],["workflowSongId",r]].map((([e,t])=>`${e}=${t}`)).join("&")),[r]),P=(0,i.v9)((e=>e.session.user?.uri)),$=l().from(P).toURLPath(!0),[U,x]=(0,n.useState)(null),{route:O,error:L}=(({redirectUri:e})=>{const t=(0,w.z)(),[r,s]=(0,n.useState)(""),[o,i]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(async()=>{try{const{token:r}=await t.requestAccountLinkToken();s(`https://www.soundtrap.com/spotify/accountlink/?redirect=${encodeURIComponent(e)}&token=${r}`)}catch(e){i("Something went wrong while trying link your account")}})()}),[t,e]),{route:r,error:o}})({redirectUri:`https://www.soundtrap.com/studio/${t}/?${E}`}),{resetMainView:_,collapseMainView:C}=(0,h.i)(),M=(0,g.g)(),R=(0,I.Y)((e=>e?.hasContext&&!e?.isPaused));(0,n.useEffect)((()=>{const e=s.current;return S.setIframe(e),()=>{S.setIframe(null)}}),[s,S,c]),(0,j.I)(m.O.EXIT,(()=>{b.goBack()})),(0,j.I)(m.O.PUBLISH,(async({data:e})=>{const t=!e.title||!e.projectId;if(x(null),t)x("Cannot publish project, title or projectId are missing.");else try{await S.publish({projectId:e.projectId,title:e.title,isPrivate:!0===e.isPrivate}),b.replace($,{referrer:"soundtrap_publish",newProjectId:e.projectId})}catch(e){x("Something went wrong while trying to publish the project.")}})),(0,n.useEffect)((()=>{R&&M?.pause()}),[R,M]),(0,n.useEffect)((()=>(C(),_)),[]);const V=L??U;return V?(0,v.jsx)(d.h,{hasError:!0,errorMessage:V}):(0,v.jsxs)(n.Suspense,{fallback:null,children:[(0,v.jsx)(p.$,{children:u.ag.get("playlist.page-title")}),(0,v.jsx)("iframe",{ref:s,src:O,className:o()(k,{[y]:e}),allow:"microphone https://www.soundtrap.com/studio;",title:"Soundtrap"})]})}))},35761:(e,t,r)=>{r.d(t,{I:()=>o});var n=r(67294),s=r(67448);function o(e,t){const r=(0,s.z)();(0,n.useEffect)((()=>{const n=r.getEvents(),s=e=>t(e);return n.addListener(e,s),()=>{n.removeListener(e,s)}}),[e,r,t])}}}]);
//# sourceMappingURL=xpui-routes-soundtrap-studio.js.map