"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[1248],{22578:(e,a,r)=>{r.d(a,{$:()=>g});var t=r(64593),i=r(96206),s=r(69691),n=r(8341),l=r(89952),o=r(67294),c=r(51615),u=r(24183);var d=r(85893);function m(e){return e.includes("Spotify")?e:`Spotify – ${e}`}const g=({children:e,usePlayingItem:a})=>{let r=m(e);(e=>{const{mainLandmarkRef:a}=(0,u.Oh)(),r=(0,c.k6)(),t=r.location?.state?.preventMoveFocus,i=(0,o.useRef)(r.length<2);i.current=r.length<2,(0,o.useEffect)((()=>{const r=a.current;!t&&!i.current&&r&&e&&(r.setAttribute("aria-label",e),r.focus())}),[e,a,t])})(e);const{isPlaying:g}=(0,s.IK)(),h=(0,n.Y)((e=>e?.item));return h&&(g||a)&&((0,l.G_)(h)?r=[h.name,h.artists.map((e=>e.name)).join(i.ag.getSeparator())].join(" • "):(0,l.iw)(h)?r=[h.name,h.show.name].join(" • "):(0,l.k6)(h)&&(r=m(i.ag.get("ad-formats.advertisement")))),(0,d.jsx)(t.q,{defaultTitle:"Spotify",defer:!1,children:(0,d.jsx)("title",{children:r})})}},70369:(e,a,r)=>{r.d(a,{$:()=>t.$});var t=r(22578)},85693:(e,a,r)=>{r.d(a,{t:()=>l});var t=r(36590),i=r(8498),s=r(75032),n=r(85893);const l=({project:e,index:a,onClick:r})=>(0,n.jsx)(t.C,{index:a,onClick:()=>r(e.key),headerText:e.title,featureIdentifier:"make_music",uri:e.originalTrackUri,delegateNavigation:!0,renderCardImage:()=>(0,n.jsx)(i.x,{images:[{url:e.imageUri}]}),renderSubHeaderContent:()=>(0,n.jsx)(s.NB,{source:e.templateDescription})})},47547:(e,a,r)=>{r.r(a),r.d(a,{UserSong:()=>X,default:()=>J,parseReleaseDate:()=>K});var t=r(67294),i=r(86706),s=r(51615),n=r(69518),l=r.n(n),o=r(32667),c=r(97348),u=r(73305),d=r(96206),m=r(18270),g=r(48690),h=r(51871),p=r(70369),x=r(60289),f=r(59482),j=r(72907),y=r(6158),b=r(55120),k=r(18686),I=r(87834),P=r(87972),v=r(26492),S=r(61901),C=r(29255),U=r(32626),R=r(30951),w=r(23716),T=r(84242),D=r(69691),E=r(8341),N=r(52404),L=r(89948),A=r(15852),_=r(42781),O=r(43315),B=r(81612),$=r(85693),F=r(1253),H=r(13153),Y=r(42922),z=r(85893);const Q=[H.QD.INDEX,H.QD.TITLE,H.QD.DURATION],q=t.memo((function({ariaLabel:e,tracks:a,creator:r,highlightUri:i,scrollToIndex:s,usePlayContextItem:n,hasHeaderRow:l=!0}){const o=(0,t.useRef)(null),c=(0,t.useRef)(!1),[u]=(0,t.useState)(null);(0,t.useEffect)((()=>{o.current&&(u?o.current.scrollToIndex(u):s&&o.current.scrollToIndex(s))}),[u,s]);const d=(0,t.useCallback)(((e,a)=>{const t=!c.current&&!!i&&i===e.uri;return t&&(c.current=!0),(0,z.jsx)(H.Ym,{index:a,trackNumber:a+1,contextUri:r.uri,uri:e.uri,duration_ms:e.duration.milliseconds,name:e.name,isPlayable:e.playability.playable,artists:[{uri:r.uri,profile:{name:r.displayName??r.name??""}}],playcount:0,shouldRenderPlayCount:!1,shouldHighLight:t,usePlayContextItem:n},a+e.uri)}),[r,i,n]),m=(0,t.useCallback)((e=>"track"in e?e.track.uri:""),[]);return(0,z.jsx)(Y.ZP,{value:"album-tracklist",children:(0,z.jsx)(H.Pv,{ariaLabel:e,tracks:a,hasHeaderRow:l,rowPlaceholder:H.uD,columns:Q,renderRow:d,resolveUri:m,nrTracks:a.length,outerRef:o},r.uri)})})),G="a4JGtYPrNWmb5GUgrYMX",M="Y3jBRL4mS97_u1yK6lml",W="uV9hvAknI8LQmO3fPuqx",X=({episode:e,creator:a})=>{const{uri:r,coverArt:n}=e,l=(0,s.k6)(),{spec:u,logger:y}=(0,A.fU)(c.createDesktopEpisodeEventFactory,{data:{uri:r}}),I=(0,w.g)(),P=(0,v.o)(),R=parseInt(new URLSearchParams((0,s.TH)().search).get("index")||"0",10),{usePlayContextItem:N,triggerPlay:L,togglePlay:_,isActive:H}=(0,T.n)({uri:r},{featureIdentifier:"episode"}),{isPlaying:Y,isActive:Q}=(0,D.$o)(r),X=n[0].url,J=(0,S.Zj)(X||null),V=(0,E.Y)((e=>e?.isPaused??void 0)),Z=Q||H,ee=(0,t.useCallback)(((e,a,t)=>{let i="play";if(!Y||0!==e&&a||(i="pause"),P({intent:i,targetUri:r,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),H&&!a)_({loggingParams:t?.()});else if(Q&&!a)V?(t?.("resume"),I.resume()):(t?.("pause"),I.pause());else{const a=t?.("play");L({seekTo:e,loggingParams:a})}}),[Y,P,r,Q,H,V,I,_,L]),ae=(0,t.useCallback)((()=>{ee(0,!1,(e=>{const a=u.actionBarFactory().playButtonFactory();let t;return t="pause"===e||Y?a.hitPause({itemToBePaused:r}):"resume"===e||Z?a.hitResume({itemToBeResumed:r}):a.hitPlay({itemToBePlayed:r}),y.logInteraction(t)}))}),[ee,Z,Y,y,u,r]);(0,t.useEffect)((()=>{if(e){const a=new URLSearchParams(location.search);if(a.has("t")){const r=a.get("t")||"0",t=1e3*parseInt(r,10);t<=e.duration.milliseconds&&ee(t,!0)}}}),[e]);const re=e.playability.playable,te=(e.coverArt||[]).map((e=>({url:e.url,width:e.width||void 0,height:e.height||void 0}))),ie=(0,t.useCallback)((()=>new URLSearchParams(l.location.search.slice(1)).get("highlight")||""),[l.location.search])(),se=(0,i.v9)(C.Gg),ne=se.overrides?.locale??se.locale,{projects:le}=(0,B.w)(!1,a.id),[oe,ce]=(0,t.useState)([]);return(0,t.useEffect)((()=>{const a=le.filter((a=>a.publishedTrackUri!==e.uri));ce(a)}),[le,e.uri]),(0,z.jsxs)("section",{"data-testid":"user-song",className:G,children:[(0,z.jsx)(p.$,{children:d.ag.get("podcasts.episode.seo.title",{name:e.name,show:e.podcast?.name??""})}),(0,z.jsxs)(x.gF,{backgroundColor:J,children:[(0,z.jsxs)(f.W,{children:[(0,z.jsx)(b.$,{size:"md",onClick:()=>_(),disabled:!re,isPlaying:Y,uri:r}),(0,z.jsx)(j.i,{text:e.name})]}),(0,z.jsx)(U._P,{menu:(0,z.jsx)(F.kn,{uri:r,sharingInfo:e.sharingInfo}),children:(0,z.jsx)(x.Oz,{dragUri:r,images:te,name:e.name,placeholderType:"album"})}),(0,z.jsxs)(x.sP,{children:[(0,z.jsx)(x.dy,{small:!0,uppercase:!0,children:"Song"}),(0,z.jsx)(U._P,{menu:(0,z.jsx)(F.kn,{uri:r,sharingInfo:e.sharingInfo}),children:(0,z.jsx)(x.xd,{dragUri:e.uri,dragLabel:e.name,children:e.name})}),(0,z.jsx)(x.QS,{creators:[a],releaseDate:K(e.releaseDate?.isoString),durationMilliseconds:e.duration.milliseconds})]})]}),(0,z.jsx)(m.o,{backgroundColor:J,children:(0,z.jsxs)(m.F,{children:[(0,z.jsx)(b.$,{onClick:ae,disabled:!re,isPlaying:Y,size:"lg",uri:r}),(0,z.jsx)(h.w,{uri:e.uri,size:g.q.md}),(0,z.jsx)(U.yj,{menu:(0,z.jsx)(F.kn,{uri:e.uri,sharingInfo:e.sharingInfo}),children:(0,z.jsx)(g.z,{label:d.ag.get("more.label.context",e.name)})})]})}),(0,z.jsxs)("div",{className:"contentSpacing",children:[(0,z.jsx)(q,{ariaLabel:e.name,tracks:[e],creator:a,highlightUri:ie,scrollToIndex:R,usePlayContextItem:N}),(0,z.jsx)("div",{className:W,children:(0,z.jsx)("div",{children:e.releaseDate?.isoString&&(0,z.jsx)(o.D,{as:"p",variant:"mesto",children:(0,O.BI)((0,O.RX)(e.releaseDate.isoString),ne,{year:"numeric",month:"long",day:"numeric"})})})})]}),oe.length>0&&(0,z.jsx)("div",{className:"contentSpacing",children:(0,z.jsx)(k.q,{index:0,id:"more-user-songs",className:M,title:d.ag.get("album-page.more-by-artist",a.displayName??a.name??"User"),total:oe.length,seeAllUri:a.uri,seeAllLabel:"Show profile",alwaysShowSeeAll:!0,children:oe.map(((e,a)=>(0,z.jsx)($.t,{index:a,project:e,onClick:()=>{}},e.key)))})})]})},J=t.memo((function(){const{episodeId:e}=(0,s.UO)(),a=l().episodeURI(e).toURI(),r=(0,N.I)(a,!1);let i="";r?.type===_.p.EPISODE&&(i=r.podcast?.uri||"");const{data:n,error:o}=(0,L.l)(i||"",!1);let c="",m="",g="";n?.type===_.p.SHOW&&(c=n.publisherName,m=l().profileURI(c).toURI(),g=n.name);const{data:h}=(0,P.J)(R.n5.getProfile,[{uri:m,playlists:10,artists:10,episodes:10}]),p={uri:m,name:g,displayName:g,id:c,images:h?[{url:h.image_url}]:[]};return!r||r.type!==_.p.EPISODE||o?(0,z.jsx)(y.h,{hasError:!1,errorMessage:d.ag.get("error.not_found.title.podcast")}):(0,z.jsx)(t.Suspense,{fallback:null,children:(0,z.jsx)(I.C,{pageId:u.Wg.PODCAST_EPISODE,uri:a,children:(0,z.jsx)(X,{episode:r,creator:p})})})}));function K(e){return e?.replace(/T.*/,"")||""}},87834:(e,a,r)=>{r.d(a,{C:()=>n});var t=r(67294),i=r(94960),s=r(85893);const n=({pageId:e,uri:a,children:r})=>{const n=(0,i.b)(),l=(0,i.H)();return(0,t.useEffect)((()=>{n?.reportPageView({pageId:e,navigationalRoot:l??void 0,entityUri:a})}),[e,l,n,a]),(0,s.jsx)(s.Fragment,{children:r})}}}]);
//# sourceMappingURL=xpui-routes-soundtrap-user-song.js.map