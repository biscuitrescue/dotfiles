"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[8059,214],{57106:(e,s,o)=>{o.d(s,{Q:()=>a});var n=o(94184),r=o.n(n);const t="_pMNGOs2KBLWGpGmunYI";var i=o(85893);function a(e){return(0,i.jsx)("section",{...e,className:r()(t,e.className)})}},14784:(e,s,o)=>{o.r(s),o.d(s,{ALL_EPISODE_SPONSORS_TESTID:()=>l,AllEpisodeSponsors:()=>S,allEpisodeSponsorsPath:()=>f.e,default:()=>E});var n=o(51615),r=o(65732),t=o(28975),i=o(57106),a=o(77186);var d=o(70214),p=o(1361),u=o(99922),c=o(85893),f=o(61737);const l="all-episode-sponsors";function S({EpisodeSponsorsWrapper:e=d.EpisodeSponsorsWrapper}){const{[t.hd]:s}=(0,n.UO)(),o=(0,a.P)(),f=(0,u.o)();return o.location.state?.[p.H]?(0,c.jsx)(i.Q,{"data-testid":l,children:(0,c.jsx)(e,{...f,numberOfSponsorsToDisplay:1/0,reason:"Episode page See All"})}):(0,c.jsx)(r.w,{to:(0,t.lc)(s)})}const E=S},70214:(e,s,o)=>{o.r(s),o.d(s,{EPISODE_SPONSORS_SHELF_TESTID:()=>v,EpisodeSponsorsWrapper:()=>D,SEE_ALL_EPISODE_SPONSORS_TESTID:()=>m,default:()=>h});var n=o(67294),r=o(1486),t=o(8271);var i=o(85893);const a=(0,n.lazy)((()=>Promise.all([o.e(1814),o.e(9033)]).then(o.bind(o,99033))));function d({fetchedEpisodeSponsorsData:e,fireTrackingEvent:s,numberOfSponsorsToDisplay:o,firedViewedEvents:d,version:p,reason:u,uri:c}){const{displayedEpisodeSponsorsData:f}=function({fetchedEpisodeSponsorsData:e,numberOfSponsorsToDisplay:s}){return(0,n.useMemo)((()=>({displayedEpisodeSponsorsData:e.slice(0,s)})),[e,s])}({fetchedEpisodeSponsorsData:e,numberOfSponsorsToDisplay:o}),l=(0,t.s4)(),S=(0,n.useMemo)((()=>f.map(((e,o)=>(0,i.jsx)(a,{fireTrackingEvent:s,firedViewedEvents:d,version:p,onClick:async function(){return l.send((0,r.$)({uri:c,reason:u,lineitem_id:f.map((e=>e.metadata.lineitemId)),ui_navigate:f.map((({clickthrough:e},s)=>o===s?e:"")),navigate_to_external_uri:f.map(((e,s)=>o===s))}))},...e},`${e.metadata.lineitem_id}-${o}`)))),[f,s,d,p,u,c,l]);return{displayedEpisodeSponsorsData:f,displayedSponsors:S}}var p=o(69518),u=o.n(p);var c=o(1361),f=o(18693);function l({firedViewedEvents:e}){const s=(0,n.useRef)();return{firedViewedEvents:s.current=e??s.current??new Set}}function S({uri:e,getEpisodeSponsors:s,fireTrackingEvent:o,numberOfSponsorsToDisplay:r,version:t,reason:i}){const{state:a}=(0,c.b)(),{episodeBase62Id:p}=function({uri:e,episodeBase62Id:s}){return{episodeBase62Id:(0,n.useMemo)((()=>s||u().from(e)?.getBase62Id()),[e,s])}}({...a?.[c.H],uri:e}),{fetchedEpisodeSponsorsData:S}=(0,f.m)({...a,episodeBase62Id:p,getEpisodeSponsors:s,version:t}),{firedViewedEvents:E}=l({...a?.[c.H]});return{uri:e,episodeBase62Id:p,fetchedEpisodeSponsorsData:S,...d({fetchedEpisodeSponsorsData:S,fireTrackingEvent:o,numberOfSponsorsToDisplay:r,firedViewedEvents:E,version:t,reason:i,uri:e}),firedViewedEvents:E,reason:i}}const E=(0,n.lazy)((()=>o.e(4791).then(o.bind(o,54791)))),v="episode-sponsors-shelf",m="see-all-episode-sponsors";function D(e){const{numberOfSponsorsToDisplay:s}=function({numberOfSponsorsToDisplay:e=3}){return{numberOfSponsorsToDisplay:e}}(e),o=S({...e,numberOfSponsorsToDisplay:s});return o.episodeBase62Id&&o.displayedSponsors.length?(0,i.jsx)(n.Suspense,{fallback:!0,children:(0,i.jsx)(E,{...e,numberOfSponsorsToDisplay:s,state:o})}):null}const h=D},1361:(e,s,o)=>{o.d(s,{H:()=>r,b:()=>t});var n=o(51615);const r="episodeSponsorsStateWithRequiredProps";function t(){return(0,n.TH)()}},18693:(e,s,o)=>{o.d(s,{F:()=>i,m:()=>a});var n=o(67294),r=o(24697),t=o(31604);const i=420;function a({episodeBase62Id:e,getEpisodeSponsors:s,fetchedEpisodeSponsorsData:a=[],version:d}){const[p,u]=(0,n.useState)(a),c=(0,n.useCallback)((async()=>{try{if(!e)throw new Error("episodeBase62Id is required to fetch episode sponsors");const n=s??(await Promise.resolve().then(o.bind(o,11401))).getEpisodeSponsors;u(await n(e,{version:d}))}catch(e){u([])}}),[e,s,d]),f=(0,r.y1)(c,i);return(0,n.useEffect)((function(){a.length||f()}),[f,a.length]),(0,t.H)(f),{fetchedEpisodeSponsorsData:p}}},99922:(e,s,o)=>{o.d(s,{o:()=>t});var n=o(87577),r=o(49207);function t(){return{version:(0,n.W6)(r.GE)?2:1}}},31604:(e,s,o)=>{o.d(s,{H:()=>p});var n=o(67294),r=o(87577),t=o(49207),i=o(40080),a=o(8341),d=o(89952);function p(e){const s=(0,r.W6)(t.oF),o=(0,a.Y)((e=>{const s=e?.item??void 0;return(0,d.k6)(s)&&s.isPodcastAd?s.id??void 0:void 0})),p=(0,i.D)(o);(0,n.useEffect)((function(){o!==p&&Boolean(o)&&setTimeout(e,s)}),[e,o,p,s])}},77186:(e,s,o)=>{o.d(s,{P:()=>t});var n=o(67294),r=o(51615);function t(){const e=(0,r.k6)(),{listen:s,location:o}=e;return(0,n.useEffect)((function(){return s(((e,s)=>{"POP"===s&&(e.state={...o.state,...e.state})}))})),e}},40080:(e,s,o)=>{o.d(s,{D:()=>r});var n=o(67294);function r(e){const s=(0,n.useRef)();return(0,n.useEffect)((()=>{s.current=e}),[e]),s.current}}}]);
//# sourceMappingURL=xpui-routes-all-episode-sponsors.js.map