"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[7704],{83295:(e,t,n)=>{n.r(t),n.d(t,{SKELETON_CARDS_COUNT:()=>wt,SKELETON_SHELVES_COUNT:()=>Et,SKELETON_SHORTCUTS_COUNT:()=>bt,default:()=>Bt});var s=n(59496),a=n(84875),i=n.n(a),o=n(90641),r=n(69062),c=n(27954),l=n(60378),u=n(62256),m=n(67642),d=n(50628),h=n(95949),x=n(19252),g=n(96001),j=n(95642),p=n(77019),f=n(45868),y=n(19505),v=n(58767),S=n(91031),C=n(23484),N=n(23032),_=n(97255),k=n(7929),P=n(23924),b=n(24860),E=n(19412);const w="view-homeShortcutsGrid-shortcuts",T="view-homeShortcutsGrid-grid",L="view-homeShortcutsGrid-shortcutLink",B="view-homeShortcutsGrid-shortcut",I="view-homeShortcutsGrid-draggable",M="view-homeShortcutsGrid-imageContainer",O="view-homeShortcutsGrid-imageWrapper",U="view-homeShortcutsGrid-image",A="view-homeShortcutsGrid-main",F="view-homeShortcutsGrid-nameWrapper",D="view-homeShortcutsGrid-name",H="EzRmGRncgnv1zFgF4dqE",J="bPmmKmSPLKMhtJSaUJRX",$="vpQWUBWS_lXRLZMRJT7w",R="GSv7K805J9Jw7LB9tn2A",W="view-homeShortcutsGrid-PlayButtonContainer",z="s9c9x_mJq197U2hBzGtV";var G=n(4637);const q=(0,s.memo)((function({item:e}){const t=(0,P._)(e.uri),n=e.duration_ms??0,{isPlaying:s,isActive:a}=(0,E.$o)(e.uri),[i]=(0,b.z)(1e4,(t=>t.item?.uri===e.uri)),o=e.resume_point?.resume_position_ms??0,r=s||a?i:o,c=Math.round(100/(n/r)),l=t===k.Om.YES,u=n&&r>0;return l||u?(0,G.jsxs)("div",{className:$,children:[l?(0,G.jsx)(N.E,{iconSize:16,semanticColor:"textSubdued"}):null,u?(0,G.jsx)(_.k,{className:R,value:c,semanticColor:"essentialBase"}):null]}):null}));var Y=n(92053),Z=n(65748),K=n(41880),V=n(9020),X=n(63667),Q=n(90399),ee=n(28314),te=n(67551),ne=n(77741),se=n(28505),ae=n(16431),ie=n(35804);const oe=(0,s.memo)((function({images:e=[],fallbackIcon:t=j.U}){const n=(0,ie.X)(e);return(0,G.jsx)("div",{className:M,children:(0,G.jsx)("div",{className:O,children:(0,G.jsx)(ae.E,{className:U,src:n?.url,loading:"lazy",testid:"shortcut-image",children:(0,G.jsx)(t,{"aria-hidden":!0})})})})}));var re=n(27509),ce=n(85345),le=n(9719);const ue=s.memo((function({index:e,item:t,fallbackIcon:n,showPlayButton:a,extraContent:r,onContextMenu:c=(()=>{}),onTouchStart:u=(()=>{}),onTouchEnd:m=(()=>{})}){const d=(0,Y.s0)(),h=(0,ce.o)(),{setColorFromUri:x,resetColor:j,clearColor:p}=(0,g.WQ)(),f=(0,Q.G3)(t.uri,t.release_date,t.resume_point?.resume_position_ms,t.resume_point?.fully_played),{spec:y,logger:S}=(0,ne.fU)(K.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:C,isActive:N,togglePlay:_}=(0,te.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"}),k=(0,v.EC)(t.uri),P=k?.type,b=(0,o.v9)(V.br),E=l.ag.getLocale(),w=(0,se.S9)({featureFlag:b,locale:E,entity:P,type:"link"});const T=(0,s.useCallback)((()=>{h({targetUri:t.uri,intent:"navigate",type:"click"});const e=y.hitUiNavigate({destination:t.uri});let n;S.logInteraction(e),k&&(n=k.toURLPath(!0));const s=w?`/${ee.F0}${E}${n}`:n;s&&d(s)}),[t.uri,S,d,h,y,k,w,E]),M=(0,s.useCallback)((()=>{x(t.uri)}),[t.uri,x]);(0,s.useEffect)((()=>()=>{p()}),[p]);const O=(0,ne.Wi)(y),U=(0,re.O1)([t.uri],t.name);return(0,G.jsx)("div",{ref:O,className:B,onContextMenu:c,onTouchStart:u,onTouchEnd:m,onMouseEnter:M,onMouseLeave:j,children:(0,G.jsxs)("div",{className:I,onDragStart:U,children:[(0,G.jsx)(oe,{images:t.images,fallbackIcon:n}),(0,G.jsxs)("div",{className:A,children:[(0,G.jsxs)("div",{className:F,children:[(0,G.jsxs)("div",{className:D,children:[f&&(0,G.jsx)(Q.Rd,{className:J}),(0,G.jsx)(le.Link,{to:t.uri,onClick:T,title:t.name,children:(0,G.jsx)(Z.D,{as:"p",variant:"balladBold",className:H,children:t.name})})]}),r||null]}),a&&(0,G.jsx)("div",{className:i()(W,{[z]:C}),children:(0,G.jsx)(X.f,{isPlaying:C,onClick:function(){h({targetUri:t.uri,intent:C?"pause":"play",type:"click"});const e=y.playButtonFactory();let n;n=C?e.hitPause({itemToBePaused:t.uri}):N?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const s=S.logInteraction(n);_({loggingParams:s})}})})]}),(0,G.jsx)("div",{onClick:T,className:L})]})})}));var me=n(60630),de=n(23487),he=n(33308),xe=n(32135),ge=n(21346);const je=s.memo((function(e){return(0,v.zO)(e.item.uri)?(0,G.jsx)(ue,{...e,fallbackIcon:j.U}):(0,S.MW)(e.item.uri)?(0,G.jsx)(C._,{menu:(0,G.jsx)(S.XL,{}),children:(0,G.jsx)(ue,{...e,fallbackIcon:j.U})}):(0,G.jsx)(C._,{menu:(0,G.jsx)(xe.X,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:j.U})})})),pe=s.memo((function(e){return(0,G.jsx)(C._,{menu:(0,G.jsx)(me.Y,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:p.c})})})),fe=s.memo((function(e){return(0,G.jsx)(C._,{menu:(0,G.jsx)(de.m,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:f.a})})})),ye=s.memo((function(e){return(0,G.jsx)(C._,{menu:(0,G.jsx)(ge.M,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:y.J,showPlayButton:!1})})})),ve=s.memo((function(e){return e.item.podcast?(0,G.jsx)(ye,{index:e.index,shouldSetBackgroundColor:e.shouldSetBackgroundColor,item:e.item.podcast,showPlayButton:e.showPlayButton}):(0,G.jsx)(C._,{menu:(0,G.jsx)(he.k,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:y.J,extraContent:(0,G.jsx)(q,{...e})})})}));var Se=n(31254),Ce=n(40307);const Ne="J6UEDIqMSJhYlwGoeUZB",_e="ZjFf4lVC48DSryAjP9qB",ke=s.memo((function(e){const t=(0,Ce.x)(),n={...e.item,...t};return(0,G.jsx)(ue,{...e,item:n,fallbackIcon:()=>(0,G.jsx)("div",{className:Ne,children:(0,G.jsx)(Se.P,{iconSize:32,className:_e})})})}));var Pe=n(23949),be=n(9023);const Ee=24,we=270,Te=200,Le=600,Be=3*we+2*Ee,Ie=80,Me=64,Oe=16,Ue=12;function Ae(e){if(null===e)return{cssProperties:{"--min-column-width":`${we}px`,"--item-height":`${Ie}px`,"--column-gap":`${Ee}px`,"--row-gap":`${Oe}px`},showPlayButton:!0};const t=e.offsetWidth,n=t<Le?Te:we;const s=Math.min(Math.floor((t+Ee)/(n+Ee)),3),a=t>=Be?Ie:Me;return{cssProperties:{"--min-column-width":`${n}px`,"--item-height":`${a}px`,"--column-gap":`${Ee}px`,"--row-gap":`${a===Me?Ue:Oe}px`},showPlayButton:(t-(s-1)*Ee)/s>=we}}function Fe(){const e=(0,s.useRef)(null),[t,n]=(0,s.useState)(Ae(null)),a=(0,s.useCallback)((()=>{null!==e.current&&n(Ae(e.current))}),[]),i=(0,s.useCallback)((t=>{e.current=t,a()}),[a]);return(0,d.a)((()=>a())),[t,i]}const De=e=>{if(null!==e&&"object"==typeof e){const{type:t,name:n}=e;return t===x.p.YOUR_EPISODES&&"string"==typeof n}return!1},He=s.memo((function({title:e,tagline:t,items:n}){const{fetchMultipleColors:a}=(0,g.WQ)(),i=!(0,Pe.k)(),o=e??(()=>{const e=(new Date).getHours();let t=l.ag.get("home.evening");return e>=5&&e<12?t=l.ag.get("home.morning"):e>=12&&e<18&&(t=l.ag.get("home.afternoon")),t})(),[r,c]=Fe();return(0,s.useEffect)((()=>{const e=n?.map(g.lh)||[];a(e)}),[n,a]),i||!n?.length?null:(0,G.jsxs)("section",{className:w,"aria-label":o,ref:c,children:[(0,G.jsx)(be.r,{title:o,titleVariant:"alto",tagline:t}),(0,G.jsx)("div",{className:T,style:r.cssProperties,children:n.filter(((e,t)=>De(e)||!e.error)).filter(((e,t)=>t<6)).map(((e,t)=>{if(De(e))return(0,G.jsx)(ke,{index:t,item:e,showPlayButton:r.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`);const n=function(e){const t=((0,v.EC)(e)||{}).type;switch(t){case v.JM.ARTIST:return fe;case v.JM.ALBUM:case v.JM.COLLECTION_ALBUM:return pe;case v.JM.PLAYLIST:case v.JM.PLAYLIST_V2:return je;case v.JM.SHOW:return ye;case v.JM.EPISODE:return ve;case v.JM.COLLECTION:return je;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),ye}}(e.uri);return(0,G.jsx)(n,{index:t,item:e,showPlayButton:r.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`)}))})]})})),Je=e=>(0,G.jsx)(m.L,{onError:e=>{(0,h.vK)(e,"HomeShortcutsGrid")},children:(0,G.jsx)(He,{...e})});var $e=n(50966),Re=n(83194);const We="zUf7jtv9GPOKC1jYO5TO",ze="T8QLel3PoQTgJUpGYj7Q",Ge=(0,s.memo)((({isLoading:e})=>{const t=(0,$e.h)("shimmer");return(0,G.jsx)("div",{className:M,children:(0,G.jsx)("div",{ref:t,className:i()(O,{[ze]:e})})})})),qe=(0,s.memo)((({isLoading:e})=>(0,G.jsx)("div",{className:i()(B,We),"data-testid":"skeleton-shortcut",children:(0,G.jsxs)("div",{className:I,children:[(0,G.jsx)(Ge,{isLoading:e}),(0,G.jsx)("div",{className:A,children:(0,G.jsx)(Re.C,{as:"p",variant:"balladBold",className:H,isLoading:e})})]})}))),Ye="v7dc5ekmeBiAYnLzV8oT",Ze=(0,s.memo)((({shortcutCount:e})=>{const[t,n]=Fe();return(0,G.jsxs)("section",{className:w,ref:n,children:[(0,G.jsx)(Re.C,{as:"h2",variant:"alto",className:Ye,charCount:25,isLoading:!0}),(0,G.jsx)("div",{className:T,style:t.cssProperties,children:[...new Array(e).keys()].slice(0,6).map(((e,t)=>(0,G.jsx)(qe,{isLoading:!0},t)))})]})}));var Ke=n(37277),Ve=n(68277),Xe=n(78682),Qe=n(75541),et=n(19193),tt=n(15996),nt=n(20890),st=n(9063),at=n(23865),it=n(79502),ot=n(86848),rt=n(45855),ct=n(85220),lt=n(78241),ut=n(10970);const mt=({spec:e,section:t,index:n})=>{const a=(0,r.W6)(lt.ty,{loadingValue:!1})?rt.N:ct.q;return(0,s.useMemo)((()=>t.sectionItems.items.some((e=>(0,ut.d)(e.content)))),[t.sectionItems])?(0,G.jsx)(ne.Nh,{spec:e.shelvesFactory(),children:(0,G.jsx)(a,{total:t.sectionItems.totalCount,seeAllUri:t.uri,pageId:t.uri,title:t.data.title?.text??"",index:n,id:t.uri,children:t.sectionItems.items.map(ut.x).filter((e=>!!e))})}):null};var dt=n(28029);const ht=({spec:e,section:t,index:n})=>(0,G.jsx)(ne.Nh,{spec:e.shelvesFactory(),children:(0,G.jsx)(dt.default,{title:t.data.title?.text??void 0,showAll:!1,index:n})});var xt=n(11253);const gt=({spec:e,greeting:t,section:n})=>(0,G.jsx)(ne.Nh,{spec:e.shortcutsFactory(),children:(0,G.jsx)(Je,{items:n.sectionItems.items.map(xt.lh),title:t??void 0})});var jt=n(55122);const pt=(0,s.lazy)((async()=>{const{FeatureActivationShelf:e}=await Promise.all([n.e(1814),n.e(8228)]).then(n.bind(n,44102));return{default:e}})),ft=({spec:e,greeting:t,section:n,index:a})=>{const i=(0,S._n)();switch(n.data?.__typename){case"HomeGenericSectionData":return(0,G.jsx)(mt,{spec:e,section:(0,jt.f)(n,n.data),index:a});case"HomeFeatureActivationSectionData":return(0,it.wW)()?(0,G.jsx)(s.Suspense,{fallback:null,children:(0,G.jsx)(pt,{})}):null;case"HomeShortsSectionData":return(0,G.jsx)(gt,{spec:e,greeting:t,section:(0,jt.f)(n,n.data)});case"HomeRecentlyPlayedSectionData":return(0,G.jsx)(ht,{spec:e,section:(0,jt.f)(n,n.data),index:a});case"HomeFeedBaselineSectionData":case"HomeNativeAdsSectionData":case"HomeOnboardingSectionData":case"HomeOnboardingSectionDataV2":return null;case"HomeYourDJSectionData":{if(!i)return null;const t=(0,jt.f)(n,n.data),{data:s,sectionItems:a}=t,o=a.items[0];if("PlaylistResponseWrapper"===o.content.__typename&&"Playlist"===o.content.data.__typename){const{data:t}=o.content;return(0,G.jsx)(S.KE,{spec:e,shelfTitle:s.title?.text??"",title:t.name,description:t.description??""})}return null}case null:case void 0:return null;default:return(0,ot._)(n.data),null}},yt=({spec:e,greeting:t,container:n})=>{const{spec:a,logger:i}=(0,ne.fU)(st.createDesktopHomeFeatureActivationShelfEventFactory,{});return(0,s.useEffect)((()=>{(0,at.wW)()&&i.logImpression(a.impressionElementFactory().impression())}),[a,i]),(0,G.jsx)(G.Fragment,{children:n.sections.items.map(((n,s)=>(0,G.jsx)(ft,{spec:e,greeting:t,section:n,index:s},`${s}-${n.uri}`)))})};var vt=n(35629),St=n(68302);const Ct=(0,s.memo)((({cardCount:e})=>(0,G.jsx)(St.X,{isLoading:!0,children:[...new Array(e).keys()].map(((e,t)=>(0,G.jsx)(vt.A,{isLoading:!0},t)))})));var Nt=n(67322),_t=n(15649);const kt=()=>(0,r.W6)(lt.Jw)===lt.pF.ONHOME?(0,G.jsx)(_t.w,{children:(0,G.jsx)(Nt.M,{onSearch:!1})}):null;var Pt=n(39305);const bt=6,Et=6,wt=6,Tt=(0,s.memo)((({shortcutCount:e,shelfCount:t,cardCount:n})=>(0,G.jsx)("section",{"data-testid":"home-page",children:(0,G.jsx)("div",{className:Pt.Z.home,children:(0,G.jsxs)("div",{className:i()(Pt.Z.content,"contentSpacing"),children:[(0,G.jsx)(Ze,{shortcutCount:e}),[...new Array(t).keys()].map(((e,t)=>(0,G.jsx)(Ct,{cardCount:n},t)))]})})}))),Lt=({spec:e})=>{(0,Ve.z)("home");const{data:t,error:n,loading:s}=(0,tt.b3)({timeZone:(0,nt.L7)()},{cacheTime:nt.us,staleTime:nt.fS});if(s)return(0,G.jsx)(Tt,{shortcutCount:bt,shelfCount:Et,cardCount:wt});if(null!==n)return(0,G.jsx)(Ke.h,{hasError:!0,errorMessage:l.ag.get("error.generic")});const a=t?.home;return"HomeResponsePayload"!==a?.__typename||0===a.sectionContainer.sections.totalCount||0===a.sectionContainer.sections.items.length?(0,G.jsx)(Ke.h,{hasError:!0,errorMessage:l.ag.get("error.generic")}):(0,G.jsx)("section",{"data-testid":"home-page",children:(0,G.jsx)("div",{className:Pt.Z.home,children:(0,G.jsx)("div",{className:i()(Pt.Z.content,"contentSpacing"),children:(0,G.jsx)(yt,{spec:e,greeting:a.greeting?.text??null,container:a.sectionContainer})})})})},Bt=()=>{const{spec:e}=(0,ne.fU)(c.createDesktopHomeEventFactory,{data:{identifier:"home",uri:"spotify:home"}}),t=(0,r.W6)(lt.yg),n=(0,o.v9)(V.br),a=(0,Qe.S)(t),i=(0,se.S9)({locale:l.ag.getLocale(),entity:"",featureFlag:n,type:"link"});return(0,G.jsx)(ne.Nh,{spec:e,children:(0,G.jsxs)(Xe.q,{config:a,children:[(0,G.jsx)(u.$,{children:(0,et.nW)({i18n:l.ag,shouldLocalize:i})}),(0,G.jsx)(s.Suspense,{fallback:null,children:(0,G.jsx)(kt,{})}),(0,G.jsx)(Lt,{spec:e})]})})}}}]);
//# sourceMappingURL=home-v2.js.map