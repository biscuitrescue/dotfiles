"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[7704],{59447:(e,t,s)=>{s.r(t),s.d(t,{SKELETON_CARDS_COUNT:()=>pt,SKELETON_SHELVES_COUNT:()=>xt,SKELETON_SHORTCUTS_COUNT:()=>ht,default:()=>ft});var n=s(67294),i=s(94184),o=s.n(i),a=s(73526),r=s(96206),c=s(70369),l=s(22247),u=s(24391),m=s(69559),d=s(27937),h=s(42781),x=s(4236),p=s(13218),g=s(70296),j=s(69518),f=s.n(j),y=s(24524),v=s(86250),C=s(39278),S=s(61251),N=s(18261),T=s(4232),k=s(80507),P=s(25988),_=s(35410),w=s(86514),E=s(97081),b=s(20006),B=s(26482),I=s(19986),L=s(52759),U=s(69691);const O="view-homeShortcutsGrid-shortcuts",A="view-homeShortcutsGrid-grid",F="view-homeShortcutsGrid-shortcutLink",D="view-homeShortcutsGrid-shortcut",M="view-homeShortcutsGrid-draggable",H="view-homeShortcutsGrid-imageContainer",R="view-homeShortcutsGrid-imageWrapper",z="view-homeShortcutsGrid-image",G="view-homeShortcutsGrid-main",W="view-homeShortcutsGrid-nameWrapper",Z="view-homeShortcutsGrid-name",q="EzRmGRncgnv1zFgF4dqE",J="bPmmKmSPLKMhtJSaUJRX",Y="vpQWUBWS_lXRLZMRJT7w",$="GSv7K805J9Jw7LB9tn2A",K="view-homeShortcutsGrid-PlayButtonContainer",V="s9c9x_mJq197U2hBzGtV";var X=s(85893);const Q=(0,n.memo)((function({item:e}){const t=(0,I._)(e.uri),s=e.duration_ms??0,{isPlaying:n,isActive:i}=(0,U.$o)(e.uri),[o]=(0,L.z)(1e4,(t=>t.item?.uri===e.uri)),a=e.resume_point?.resume_position_ms??0,r=n||i?o:a,c=Math.round(100/(s/r)),l=t===B.Om.YES,u=s&&r>0;return l||u?(0,X.jsxs)("div",{className:Y,children:[l?(0,X.jsx)(E.E,{iconSize:16,semanticColor:"textSubdued"}):null,u?(0,X.jsx)(b.k,{className:$,value:c,semanticColor:"essentialBase"}):null]}):null}));s(57658);var ee=s(51615),te=s(32667),se=s(43864),ne=s(82627),ie=s(91355),oe=s(84242),ae=s(15852),re=s(57784),ce=s(26492),le=s(67892),ue=s(89104),me=s(49961);const de=(0,n.memo)((function({images:e=[],fallbackIcon:t=y.U}){const s=(0,me.X)(e);return(0,X.jsx)("div",{className:H,children:(0,X.jsx)("div",{className:R,children:(0,X.jsx)(ue.E,{className:z,src:s?.url,loading:"lazy",testid:"shortcut-image",children:(0,X.jsx)(t,{"aria-hidden":!0})})})})})),he=n.memo((function({index:e,item:t,fallbackIcon:s,showPlayButton:i,extraContent:a,onContextMenu:r=(()=>{}),onTouchStart:c=(()=>{}),onTouchEnd:l=(()=>{})}){const u=(0,ee.k6)(),m=(0,ce.o)(),{setColorFromUri:d,resetColor:h,clearColor:x}=(0,g.WQ)(),p=(0,ie.G3)(t.uri,t.release_date,t.resume_point?.resume_position_ms,t.resume_point?.fully_played),{spec:j,logger:y}=(0,ae.fU)(se.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:v,isActive:C,togglePlay:S}=(0,oe.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});const N=(0,n.useCallback)((()=>{m({targetUri:t.uri,intent:"navigate",type:"click"});const e=j.hitUiNavigate({destination:t.uri});y.logInteraction(e),u.push(f().from(t.uri).toURLPath(!0))}),[u,t.uri,y,m,j]),T=(0,n.useCallback)((()=>{d(t.uri)}),[t.uri,d]);(0,n.useEffect)((()=>()=>{x()}),[x]);const k=(0,ae.Wi)(j),P=(0,re.O1)([t.uri],t.name);return(0,X.jsx)("div",{ref:k,className:D,onContextMenu:r,onTouchStart:c,onTouchEnd:l,onMouseEnter:T,onMouseLeave:h,children:(0,X.jsxs)("div",{className:M,onDragStart:P,children:[(0,X.jsx)(de,{images:t.images,fallbackIcon:s}),(0,X.jsxs)("div",{className:G,children:[(0,X.jsxs)("div",{className:W,children:[(0,X.jsxs)("div",{className:Z,children:[p&&(0,X.jsx)(ie.Rd,{className:J}),(0,X.jsx)(le.r,{to:t.uri,onClick:N,title:t.name,children:(0,X.jsx)(te.D,{as:"p",variant:"balladBold",className:q,children:t.name})})]}),a||null]}),i&&(0,X.jsx)("div",{className:o()(K,{[V]:v}),children:(0,X.jsx)(ne.f,{isPlaying:v,onClick:function(){m({targetUri:t.uri,intent:v?"pause":"play",type:"click"});const e=j.playButtonFactory();let s;s=v?e.hitPause({itemToBePaused:t.uri}):C?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const n=y.logInteraction(s);S({loggingParams:n})}})})]}),(0,X.jsx)("div",{onClick:N,className:F})]})})})),xe=n.memo((function(e){return f().isCollection(e.item.uri)?(0,X.jsx)(he,{...e,fallbackIcon:y.U}):(0,X.jsx)(N._,{menu:(0,X.jsx)(_.X,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:y.U})})})),pe=n.memo((function(e){return(0,X.jsx)(N._,{menu:(0,X.jsx)(T.Y,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:v.c})})})),ge=n.memo((function(e){return(0,X.jsx)(N._,{menu:(0,X.jsx)(k.m,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:C.a})})})),je=n.memo((function(e){return(0,X.jsx)(N._,{menu:(0,X.jsx)(w.M,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:S.J,showPlayButton:!1})})})),fe=n.memo((function(e){return e.item.podcast?(0,X.jsx)(je,{index:e.index,shouldSetBackgroundColor:e.shouldSetBackgroundColor,item:e.item.podcast,showPlayButton:e.showPlayButton}):(0,X.jsx)(N._,{menu:(0,X.jsx)(P.k,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:S.J,extraContent:(0,X.jsx)(Q,{...e})})})}));var ye=s(11436),ve=s(49068);const Ce="J6UEDIqMSJhYlwGoeUZB",Se="ZjFf4lVC48DSryAjP9qB",Ne=n.memo((function(e){const t=(0,ve.x)(),s={...e.item,...t};return(0,X.jsx)(he,{...e,item:s,fallbackIcon:()=>(0,X.jsx)("div",{className:Ce,children:(0,X.jsx)(ye.P,{iconSize:32,className:Se})})})})),Te=24,ke=270;function Pe(e){if(null===e)return{cssProperties:{"--min-column-width":"270px","--item-height":"80px","--column-gap":"24px","--row-gap":"16px"},showPlayButton:!0};const t=e.offsetWidth,s=t<600?200:ke;const n=Math.min(Math.floor((t+Te)/(s+Te)),3),i=t>=858?80:64;return{cssProperties:{"--min-column-width":`${s}px`,"--item-height":`${i}px`,"--column-gap":"24px","--row-gap":`${64===i?12:16}px`},showPlayButton:(t-(n-1)*Te)/n>=ke}}function _e(){const e=(0,n.useRef)(null),[t,s]=(0,n.useState)(Pe(null)),i=(0,n.useCallback)((()=>{null!==e.current&&s(Pe(e.current))}),[]),o=(0,n.useCallback)((t=>{e.current=t,i()}),[i]);return(0,m.a)((()=>i())),[t,o]}const we=e=>{if(null!==e&&"object"==typeof e){const{type:t,name:s}=e;return t===h.p.YOUR_EPISODES&&"string"==typeof s}return!1},Ee=n.memo((function({title:e,tagline:t,items:s}){const{fetchMultipleColors:i}=(0,g.WQ)(),o=!(0,x.k)(),a=e??(()=>{const e=(new Date).getHours();let t=r.ag.get("home.evening");return e>=5&&e<12?t=r.ag.get("home.morning"):e>=12&&e<18&&(t=r.ag.get("home.afternoon")),t})(),[c,l]=_e();return(0,n.useEffect)((()=>{const e=s?.map(g.lh)||[];i(e)}),[s,i]),o||!s?.length?null:(0,X.jsxs)("section",{className:O,"aria-label":a,ref:l,children:[(0,X.jsx)(p.r,{title:a,titleVariant:"alto",tagline:t}),(0,X.jsx)("div",{className:A,style:c.cssProperties,children:s.filter(((e,t)=>we(e)||!e.error)).filter(((e,t)=>t<6)).map(((e,t)=>{if(we(e))return(0,X.jsx)(Ne,{index:t,item:e,showPlayButton:c.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`);const s=function(e){const t=(f().from(e)||{}).type;switch(t){case f().Type.ARTIST:return ge;case f().Type.ALBUM:case f().Type.COLLECTION_ALBUM:return pe;case f().Type.PLAYLIST:case f().Type.PLAYLIST_V2:return xe;case f().Type.SHOW:return je;case f().Type.EPISODE:return fe;case f().Type.COLLECTION:return xe;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),je}}(e.uri);return(0,X.jsx)(s,{index:t,item:e,showPlayButton:c.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`)}))})]})})),be=e=>(0,X.jsx)(u.L,{onError:e=>{(0,d.vK)(e,"HomeShortcutsGrid")},children:(0,X.jsx)(Ee,{...e})});var Be=s(96001);const Ie="zUf7jtv9GPOKC1jYO5TO",Le="T8QLel3PoQTgJUpGYj7Q",Ue=(0,n.memo)((({isLoading:e})=>{const t=(0,Be.h)("shimmer");return(0,X.jsx)("div",{className:H,children:(0,X.jsx)("div",{ref:t,className:o()(R,{[Le]:e})})})})),Oe=(0,n.memo)((({isLoading:e})=>(0,X.jsx)("div",{className:o()(D,Ie),"data-testid":"skeleton-shortcut",children:(0,X.jsxs)("div",{className:M,children:[(0,X.jsx)(Ue,{isLoading:e}),(0,X.jsx)("div",{className:G,children:(0,X.jsx)(l.C,{as:"p",variant:"balladBold",className:q,isLoading:e})})]})}))),Ae="v7dc5ekmeBiAYnLzV8oT",Fe=(0,n.memo)((({shortcutCount:e})=>{const[t,s]=_e();return(0,X.jsxs)("section",{className:O,ref:s,children:[(0,X.jsx)(l.C,{as:"h2",variant:"alto",className:Ae,charCount:25,isLoading:!0}),(0,X.jsx)("div",{className:A,style:t.cssProperties,children:[...new Array(e).keys()].slice(0,6).map(((e,t)=>(0,X.jsx)(Oe,{isLoading:!0},t)))})]})}));var De=s(6158),Me=s(13983),He=s(87577),Re=s(49207),ze=s(28638),Ge=s(62572);const We=()=>(0,He.W6)(Re.Jw)===Re.pF.ONHOME?(0,X.jsx)(ze.w,{children:(0,X.jsx)(Ge.M,{onSearch:!1})}):null;var Ze=s(81993),qe=s(29393),Je=s(41092),Ye=s(87194),$e=s(47094),Ke=s(38470),Ve=s(86868),Xe=s(20451),Qe=s(18686),et=s(30343);const tt=({spec:e,section:t,index:s})=>{const i=(0,He.W6)(Re.ty,{loadingValue:!1})?Xe.N:Qe.q;return(0,n.useMemo)((()=>t.sectionItems.items.some((e=>(0,et.d)(e.content)))),[t.sectionItems])?(0,X.jsx)(ae.Nh,{spec:e.shelvesFactory(),children:(0,X.jsx)(i,{total:t.sectionItems.totalCount,seeAllUri:t.uri,pageId:t.uri,title:t.data.title?.text??"",index:s,id:t.uri,children:t.sectionItems.items.map(et.x)})}):null};var st=s(56607);const nt=({spec:e,section:t,index:s})=>(0,X.jsx)(ae.Nh,{spec:e.shelvesFactory(),children:(0,X.jsx)(st.default,{title:t.data.title?.text??void 0,showAll:!1,index:s})});var it=s(28791);const ot=({spec:e,greeting:t,section:s})=>(0,X.jsx)(ae.Nh,{spec:e.shortcutsFactory(),children:(0,X.jsx)(be,{items:s.sectionItems.items.map(it.lh),title:t??void 0})}),at=(0,n.lazy)((async()=>{const{FeatureActivationShelf:e}=await Promise.all([s.e(1814),s.e(8228)]).then(s.bind(s,32791));return{default:e}})),rt=({spec:e,greeting:t,section:s,index:n})=>{switch(s.data?.__typename){case"HomeGenericSectionData":return(0,X.jsx)(tt,{spec:e,section:(0,Ve.f)(s,s.data),index:n});case"HomeFeatureActivationSectionData":return(0,$e.wW)()?(0,X.jsx)(at,{}):null;case"HomeShortsSectionData":return(0,X.jsx)(ot,{spec:e,greeting:t,section:(0,Ve.f)(s,s.data)});case"HomeRecentlyPlayedSectionData":return(0,X.jsx)(nt,{spec:e,section:(0,Ve.f)(s,s.data),index:n});case"HomeFeedBaselineSectionData":case"HomeNativeAdsSectionData":case"HomeOnboardingSectionData":case null:case void 0:return null;default:return(0,Ke._)(s.data),null}},ct=({spec:e,greeting:t,container:s})=>{const{spec:i,logger:o}=(0,ae.fU)(Je.createDesktopHomeFeatureActivationShelfEventFactory,{});return(0,n.useEffect)((()=>{(0,Ye.wW)()&&o.logImpression(i.impressionElementFactory().impression())}),[i,o]),(0,X.jsx)(X.Fragment,{children:s.sections.items.map(((s,n)=>(0,X.jsx)(rt,{spec:e,greeting:t,section:s,index:n},`${n}-${s.uri}`)))})};var lt=s(69756),ut=s(60653);const mt=(0,n.memo)((({cardCount:e})=>(0,X.jsx)(ut.X,{isLoading:!0,children:[...new Array(e).keys()].map(((e,t)=>(0,X.jsx)(lt.A,{isLoading:!0},t)))})));var dt=s(76728);const ht=6,xt=6,pt=6,gt=(0,n.memo)((({shortcutCount:e,shelfCount:t,cardCount:s})=>(0,X.jsx)("section",{"data-testid":"home-page",children:(0,X.jsx)("div",{className:dt.Z.home,children:(0,X.jsxs)("div",{className:o()(dt.Z.content,"contentSpacing"),children:[(0,X.jsx)(Fe,{shortcutCount:e}),[...new Array(t).keys()].map(((e,t)=>(0,X.jsx)(mt,{cardCount:s},t)))]})})}))),jt=({spec:e})=>{(0,Me.z)("home");const{data:t,error:s,loading:n}=(0,Ze.b3)({timeZone:(0,qe.L7)()},{cacheTime:qe.us,staleTime:qe.fS});if(n)return(0,X.jsx)(gt,{shortcutCount:ht,shelfCount:xt,cardCount:pt});if(null!==s)return(0,X.jsx)(De.h,{hasError:!0,errorMessage:r.ag.get("error.generic")});const i=t?.home;return"HomeResponsePayload"!==i?.__typename||0===i.sectionContainer.sections.totalCount||0===i.sectionContainer.sections.items.length?(0,X.jsx)(De.h,{hasError:!0,errorMessage:r.ag.get("error.generic")}):(0,X.jsx)("section",{"data-testid":"home-page",children:(0,X.jsx)("div",{className:dt.Z.home,children:(0,X.jsx)("div",{className:o()(dt.Z.content,"contentSpacing"),children:(0,X.jsx)(ct,{spec:e,greeting:i.greeting?.text??null,container:i.sectionContainer})})})})},ft=()=>{const{spec:e}=(0,ae.fU)(a.createDesktopHomeEventFactory,{data:{identifier:"home",uri:"spotify:home"}});return(0,X.jsxs)(ae.Nh,{spec:e,children:[(0,X.jsx)(c.$,{children:r.ag.get("page.generic-title")}),(0,X.jsx)(n.Suspense,{fallback:null,children:(0,X.jsx)(We,{})}),(0,X.jsx)(jt,{spec:e})]})}}}]);
//# sourceMappingURL=home-v2.js.map